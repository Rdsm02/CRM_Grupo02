<div class="kt-grid kt-grid--desktop kt-grid--ver kt-grid--ver-desktop kt-app ">

	<!-- /col-md-3 col-lg-3 -->
	<!------------------------------- /Section Neg√≥cios ------------------------------------------------------------------------>


	<div class="col-md-12 col-lg-12">

		<!------------------------------- Section Notas e Atividades -------------------------------------------------------------->
		<div class="row">
			<div class="col-xl-12">
				<div class="header-box-padrao kt-portlet kt-portlet--head--noborder kt-portlet--height-fluid">
					<div class="kt-portlet__head kt-portlet__head--noborder">
						<div class="kt-portlet__head-label col-xl-12">
							<h3 class="kt-portlet__head-title" style="margin-left: auto; margin-right: auto;">Cadastro de N√≠vel de Instru√ß√£o</h3>
						</div>

					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-xl-12">
				<div class="body-box-padrao kt-portlet__body kt-portlet__body--fluid kt-portlet__body--fit" style="">
					<div class="form-group" style="margin-left: 5%; margin-right: 25%; padding-top: 3%;">

						<div class="input-group">

							<input type="text" class="form-control" id="campoCadastroNivelDeInstrucao" placeholder="Insira o N√≠vel de Instrucao..." aria-describedby="basic-addon1" style="border-top: none; border-right: none; border-left: none; border-bottom-color: black;">
						</div>
						<span class="form-text text-muted">N√£o √© permitido caracteres especiais. ex: !@#$%¬®&amp;*()</span>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-xl-12">
				<div class="footer-box-padrao kt-portlet kt-portlet--footer--noborder ">
					<div class="box-botao-salvar" style="padding-top: 0px;">
						<button type="button" id="cadastroNivelInstrucao" class="btn btn-salvar btn-brand" onclick="cadastrarAcaoCliente()">SALVAR</button>
					</div>
				</div>
			</div>
		</div>
		<!------------------------------- /Section Notas e Atividades ------------------------------------------------------------------------>

		<!------------------------------- Section Linha do Tempo ------------------------------------------------------------------------>
		<div class="kt-portlet lista" style="margin: 0 0px;">

			<div class="kt-portlet__head lista-header"></div>

			<div class="kt-portlet__body body-list">

				<div class="kt-section">
					<div class="kt-section__content">
						<table class="table table-striped filtro">
							<thead>
								<tr>
									<th>IDENTIFICADOR</th>
									<th>DESCRICAO</th>
									<th>STATUS</th>
									<th>ACOES</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="nivel : ${nivelInstrucaoLista}">
									<th scope="row"><span class="nome-lista" th:text="${nivel.id}"></span></th>
									<td>
										<h6 th:text="${nivel.descricao}"></h6>
									</td>
									<td>
										<div class="bootstrap-switch bootstrap-switch-wrapper bootstrap-switch-animate bootstrap-switch-on" id="switchStatus" style="width: 106px;">
											<div class="bootstrap-switch-container" id="switchMover" style="width: 185px;margin-left: 0px;" th:style="${(nivel.status).equals('1')} ? 'width: 185px; margin-left: 0px;' : 'width: 185px; margin-left: -80px;'">
												<span class="bootstrap-switch-handle-on bootstrap-switch-success" style="width: 52px;">Ativo</span>
												<span class="bootstrap-switch-label" style="width: 52px;padding-left: 14%;">&nbsp;</span>
												<span class="bootstrap-switch-handle-off bootstrap-switch-danger" style="width: 52px;padding-left: 15px;">Inativo</span>
												<input type="checkbox" th:checked="${(nivel.status).equals('1')} ? 'true' : 'false'">
												 <input type="hidden" id="status" name="status" th:value="${nivel.status}">
											</div>
										</div>
									</td>
									<td>
										<div class="kt-demo-icon__preview">
											<i class="flaticon-edit" id="botaoeditarCamposTabela" style="cursor: pointer;"></i>
										</div>
									</td>
								</tr>
								<!-- <tr>
									<th scope="row"><span class="nome-lista">02</span></th>
									<td>
										<h6>Bacharel</h6>
									</td>
									<td><span style="width: 113px;"><span class="kt-badge kt-badge--danger kt-badge--dot" style="margin: 0px;"></span>&nbsp;<span class="kt-font-bold kt-font-danger">Inativo</span></span></td>
									<td><div class="kt-demo-icon__preview">
											<i class="flaticon-edit"></i>
										</div></td>
								</tr>
								<tr>
									<th scope="row"><span class="nome-lista">03</span></th>
									<td>
										<h6>Tecn√≥logo</h6>
									</td>
									<td><span style="width: 113px;"><span class="kt-badge kt-badge--success kt-badge--dot" style="margin: 0px;"></span>&nbsp;<span class="kt-font-bold kt-font-success">Ativo</span></span></td>
									<td><div class="kt-demo-icon__preview">
											<i class="flaticon-edit"></i>
										</div></td>
								</tr>
								<tr>
									<th scope="row"><span class="nome-lista">04</span></th>
									<td>
										<h6>P√≥s Gradua√ß√£o</h6>
									</td>
									<td><span style="width: 113px;"><span class="kt-badge kt-badge--success kt-badge--dot" style="margin: 0px;"></span>&nbsp;<span class="kt-font-bold kt-font-success">Ativo</span></span></td>
									<td><div class="kt-demo-icon__preview">
											<i class="flaticon-edit"></i>
										</div></td>
								</tr> -->
							</tbody>
						</table>
						<div class="row">
							<div class="col-md-4">
								<label style="margin-left: 15%;">Itens por p√°gina: </label>
								<div class="dropdown dropdown-inline">

									<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">10</button>
									<div class="dropdown-menu" aria-labelledby="dropdownMenuButton" x-placement="top-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 0px, 0px);">
										<a class="dropdown-item" style="cursor: pointer;">10</a> <a class="dropdown-item" style="cursor: pointer;">20</a> <a class="dropdown-item" style="cursor: pointer;">50</a>
									</div>
								</div>
							</div>
							<div class="col-md-6">
								<div style="float: right; margin-right: 3%;">
									<button type="button" id="anterior" class="btn btn-info" style="border-radius: 50%;">&lt;</button>
									<div class="btn-group btn-pill" role="group" aria-label="Button group with nested dropdown">
										<button type="button" class="btn btn-info">1</button>
										<button type="button" class="btn btn-info selected">2</button>
										<button type="button" class="btn btn-info">3</button>
										<button type="button" class="btn btn-info">4</button>
										<button type="button" class="btn btn-info">5</button>
										<button type="button" class="btn btn-info">6</button>
										<button type="button" class="btn btn-info">7</button>
										<button type="button" class="btn btn-info">8</button>
										<button type="button" class="btn btn-info">9</button>
									</div>
									<button type="button" id="proximo" class="btn btn-info" style="border-radius: 50%;">&gt;</button>
								</div>
							</div>
							<div class="col-md-2">
								<div style="float: right; margin-right: 5%; position: relative; width: 100%; height: 100%; text-align: center; padding-top: 5%;">
									<label style="margin: 0px;" id="quantidadeDeRegistroLabel">Total de Registros:</label><label style="margin: 0px;" id="quantidaDeRegistrosCampo">20</label>
								</div>
							</div>

						</div>
					</div>



				</div>

			</div>

		</div>





		<!------------------------------- /Section Linha do Tempo ------------------------------------------------------------------------>

	</div>
	<!-- /col-md-9 col-lg-9 -->

</div>

<script>
	var url = window.location.origin;

	var nomePath = window.location.pathname;

	var array = nomePath.split("/");

	//var dominio = url+"/"+array[1];
		
	var textoEditarTabela;
	
	var verificarCampoAberto = false;
	
	
	$(document).ready(function() {		

		chamarElementos();

	});
	
	function chamarElementos(){
		$("table.filtro > tbody > tr > td").on( "click", "div > #botaoeditarCamposTabela", function(){
			if((verificarCampoAberto == false)){
				verificarCampoAberto = true;
				var botaoEditar = $(this);
				var linhaTabelaEditar = $(this).closest("tr");
				textoEditarTabela = linhaTabelaEditar.find("td:nth-child(2)").children().text();
				linhaTabelaEditar.find("td:nth-child(2) > h6").text('');
				linhaTabelaEditar.find("td:nth-child(2)").children().append('<input type="text" name="lname">');
				linhaTabelaEditar.find("td:nth-child(2) > h6 > input").val(textoEditarTabela);			
				
				linhaTabelaEditar.find("td:nth-child(4) > div").children().remove();
				linhaTabelaEditar.find("td:nth-child(4) > div").append('<i class="flaticon-like" id="botaoSalvarAlteracaoTabela" style="margin-right:10%; cursor: pointer;"></i>');
				linhaTabelaEditar.find("td:nth-child(4) > div").append('<i class="flaticon-circle" id="botaoCancelarAlteracaoTabela" style="cursor: pointer;"></i>');
			}else{
				alert("H· outro campo aberto. Feche o campo aberto para prosseguir!!!");
			}
			
			
		});
		
		$("table.filtro > tbody > tr > td > div").on( "click", "#botaoSalvarAlteracaoTabela", function(){
			var botaoSalvarAlteracao = $(this);
			var linhaTabelaEditar = $(this).closest("tr");
			var idLinhaTabela = linhaTabelaEditar.find(".nome-lista").text();
			var textoInputAlteracaoTabela = linhaTabelaEditar.find("td:nth-child(2) > h6 > input").val();
			var statusLinhaTabela = linhaTabelaEditar.find("td:nth-child(3) > div > div > input#status").val();
			
			var objeto = new Object();
			objeto.id = idLinhaTabela;
			objeto.descricao = textoInputAlteracaoTabela;
			objeto.status = statusLinhaTabela;
			
			var nivelInstrucaoJSON = JSON.stringify(objeto);			
			
			$.ajax({
				type : "POST",
				url : dominio + "/nivelInstrucaoREST/editarNivelInstrucao",
				data : nivelInstrucaoJSON,
				contentType : "application/json",
				dataType : "JSON",
				async : false,
				success : function(response) {
					console.log("ok!");
						setTimeout(function() {
							var inputTabela = linhaTabelaEditar.find("td:nth-child(2) > h6");
							inputTabela.text(textoInputAlteracaoTabela);
							linhaTabelaEditar.find("td:nth-child(4) > div").children().remove();
							linhaTabelaEditar.find("td:nth-child(4) > div").append('<i class="flaticon-edit" id="botaoeditarCamposTabela" style="cursor: pointer;"></i>');
							verificarCampoAberto = false;
					}, 1000);
 
				}
			});
			
		});
		
		$("table.filtro > tbody > tr > td > div").on( "click", "#botaoCancelarAlteracaoTabela", function(){
			var botaoCancelarAlteracao = $(this);
			var linhaTabelaEditar = $(this).closest("tr");
			var inputTabela = linhaTabelaEditar.find("td:nth-child(2) > h6");
			inputTabela.children().remove();
			inputTabela.text(textoEditarTabela);
			linhaTabelaEditar.find("td:nth-child(4) > div").children().remove();
			linhaTabelaEditar.find("td:nth-child(4) > div").append('<i class="flaticon-edit" id="botaoeditarCamposTabela" style="cursor: pointer;"></i>');
			verificarCampoAberto = false;
		});
		
		$("table.filtro > tbody > tr > td:nth-child(3)").on( "click", "#switchStatus", function(){
	
			var switchPrincipal = $(this);
			if($(this).find("#switchMover > input[type=checkbox]:nth-child(4):checked").length == 1){
				var objeto = new Object();
				objeto.id = $(this).closest("tr").find(".nome-lista").text();
				objeto.descricao = $(this).closest("tr").find("td:nth-child(2) > h6").text();
				objeto.status = 0;
				
				var nivelInstrucaoJSON = JSON.stringify(objeto);
				
				$.ajax({
					type : "POST",
					url : dominio + "/nivelInstrucaoREST/editarNivelInstrucao",
					data : nivelInstrucaoJSON,
					contentType : "application/json",
					dataType : "JSON",
					async : false,
					success : function(response) {
						switchPrincipal.find("#switchMover").css("margin-left", "-80px");
						switchPrincipal.find("#switchMover > input[type=checkbox]:nth-child(4)").removeAttr("checked");
						}
				});
				
				
			}else{
				
				var objeto = new Object();
				objeto.id = $(this).closest("tr").find(".nome-lista").text();
				objeto.descricao = $(this).closest("tr").find("td:nth-child(2) > h6").text();
				objeto.status = 1;
				
				var nivelInstrucaoJSON = JSON.stringify(objeto);
				
				$.ajax({
					type : "POST",
					url : dominio + "/nivelInstrucaoREST/editarNivelInstrucao",
					data : nivelInstrucaoJSON,
					contentType : "application/json",
					dataType : "JSON",
					async : false,
					success : function(response) {
						switchPrincipal.find("#switchMover").css("margin-left", "0px");
						switchPrincipal.find("#switchMover > input[type=checkbox]:nth-child(4)").attr("checked", "checked");
					}
				});
			}
			
		});
	}
	
	function abrirModalNivelInstrucao(id){
		$('#modal-nivelInstrucao').modal('show');
		alert(id);
		
	}
	
	function cadastrarAcaoCliente() {
		var objeto = new Object();
		objeto.id = null;
		objeto.descricao = $("#campoCadastroNivelDeInstrucao").val();
		objeto.status = "1";

		var nivelInstrucaoJSON = JSON.stringify(objeto);
		$.ajax({
			type : "POST",
			url : dominio + "/nivelInstrucaoREST/cadastrarNivelInstrucao",
			data : nivelInstrucaoJSON,
			contentType : "application/json",
			dataType : "JSON",
			async : false,
			success : function(response) {

				setTimeout(function() {
					$("#central").load(dominio + "/nivelInstrucao/cadastrarNivelInstrucao");
				}, 1000);

			}
		});		
		
	}
	
	 
		$(".dropdown-inline > div > a").click(function(){
		
		var valorSelecionado = $(this).text();
		$(".dropdown-inline > button").text(valorSelecionado);
		
		paginator(valorSelecionado);
		
		
		});
	
	
	
	
	var tamanhoLinhas;
	var listaDeTuplas = new Array();
	function paginator(tamanhoLinhas){// = 20;
		
		var tamanhoTotalTabela = $("table.filtro > tbody > tr").length; // 40
		
		for(var i = 1; i <= tamanhoTotalTabela; i++){
			listaDeTuplas.push($("table.filtro > tbody > tr:nth-child("+ i +")"));
		}
		$("table.filtro > tbody").children().remove();
		for(var i = 0; i < tamanhoLinhas; i++){
			
			$("table.filtro > tbody").append(listaDeTuplas[i]);
		}
		chamarElementos();
		
	} 
</script>